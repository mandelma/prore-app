import{B as w,i as J,o as p,w as r,h as b,y as u,e as l,l as q,u as ue,C as z,x as k,r as d,k as me,D as pe,c,b as i,J as ce,f as fe,g as n,p as ve,Z as C,G as y,z as h,E as ge,A,v as O,F as ke,m as U,n as ye,T as be,H as he,L as we,M as Ve,I as _e,K as xe,t as Te}from"./index-DVfyyoyg.js";import{s as Se,o as je}from"./index-BwMeg2vM.js";import{l as Me}from"./loadGoogleMap-DZ-zVA3K.js";/* empty css                                                                         *//* empty css                                                                      */import"./index-93e-Jyro.js";const Fe="/assets/map-BDksWA_C.gif",Le=Object.assign({name:"HandleToast"},{__name:"ToastHandler",props:{modelValue:{type:Boolean,default:!1},toastName:{type:String,default:""},iconState:{type:String,default:""},text:{type:String,default:""}},emits:["update:modelValue"],setup(B,{emit:j}){const f=B,v=j,V=w({get:()=>f.modelValue,set:_=>v("update:modelValue",_)});return(_,t)=>(p(),J(l(q),{modelValue:V.value,"onUpdate:modelValue":t[0]||(t[0]=o=>V.value=o),autohide:"",delay:3e3,stacking:!1,position:"top-center",color:f.toastName,icon:f.iconState},{title:r(()=>[...t[1]||(t[1]=[b("PROKEIKKATORI",-1)])]),default:r(()=>[b(" "+u(f.text),1)]),_:1},8,["modelValue","color","icon"]))}}),He={style:{padding:"13px 0 20px 0"}},Ce={class:"form-card"},Ae={style:{"margin-top":"10px",color:"#00BFFFFF"}},Oe={class:"field-wrapper"},Be={key:0},De={key:1},Ie={class:"flex items-center gap-2"},Ee={key:0,class:"field-footer"},Ne=["src"],Ke={class:"field-wrapper"},Re={key:0,class:"field-footer"},ze={class:"input-group"},Ue={key:0,class:"field-footer"},Je={style:{"text-align":"center","padding-bottom":"27px"}},qe={class:"field-wrapper"},Pe={class:"field-wrapper"},Ge={key:0,class:"field-footer"},We={class:"field-wrapper"},$e={class:"field-wrapper"},Ze={key:0,class:"field-footer"},Qe={class:"message-counter"},oa=Object.assign({name:"recipient-form"},{__name:"RecipientForm",emits:["createBookingMultiple"],setup(B,{emit:j}){const f=j,{locale:v,t:V}=ue(),_=fe(),t=z({profession:"",orderHeader:"",address:"",dateTime:"",explanation:""}),o=z({}),P=()=>(o.profession=t.profession?"":"Profession is required",o.orderHeader=t.orderHeader?"":"Header is required",o.address=t.address?"":"Address is required",o.dateTime=t.dateTime?"":"Date is required",o.explanation=t.explanation?"":"Kuvaus is required",!o.profession&&!o.orderHeader&&!o.address&&!o.dateTime&&!o.explanation);k(()=>t.profession,()=>o.profession=""),k(()=>t.orderHeader,()=>o.orderHeader=""),k(()=>t.address,()=>o.address=""),k(()=>t.dateTime,()=>o.dateTime=""),k(()=>t.explanation,()=>o.explanation="");const G=d(s=>{let a=s.target.value.replace(/[^0-9.]/g,"");const m=a.split(".");m.length>2&&(a=m[0]+"."+m.slice(1).join("")),a.startsWith(".")&&(a="0"+a),s.target.value=a,I.value=a});d(50);const M=d(!1),D=d(""),W=d(""),$=me(),I=d(""),x=d(!1);d("");const F=d(!1),Z=je,Q=Fe,T=d(""),L=d(null),H=d(null),E=d(null),N=d(!1),X=d(""),Y=d(""),ee=d("");w(()=>({en:"en",fi:"fi",sv:"sv",et:"et"})[v.value]??"fi");const K=w(()=>{switch(v.value){case"en":return{firstDay:0,title:"Select date",monthsFull:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdaysFull:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Su","Mo","Tu","We","Th","Fr","Sa"],weekdaysNarrow:["S","M","T","W","T","F","S"],cancelBtnText:"Cancel",cancelLabel:"Cansel",okLabel:"OK",twelveHour:!0};case"sv":return{firstDay:1,title:"Rootsi date",monthsFull:["januari","februari","mars","april","maj","juni","juli","augusti","september","oktober","november","december"],monthsShort:["jan","feb","mar","apr","maj","jun","jul","aug","sep","okt","nov","dec"],weekdaysFull:["söndag","måndag","tisdag","onsdag","torsdag","fredag","lördag"],weekdaysShort:["sö","må","ti","on","to","fr","lö"],weekdaysNarrow:["S","M","T","O","T","F","L"],cancelBtnText:"Avbryt",cancelLabel:"Avbryt",okLabel:"OK",twelveHour:!1};case"et":return{firstDay:1,title:"Vali kuupäev",monthsFull:["jaanuar","veebruar","märts","aprill","mai","juuni","juuli","august","september","oktoober","november","detsember"],monthsShort:["jaan","veebr","märts","apr","mai","juuni","juuli","aug","sept","okt","nov","dets"],weekdaysFull:["pühapäev","esmaspäev","teisipäev","kolmapäev","neljapäev","reede","laupäev"],weekdaysShort:["P","E","T","K","N","R","L"],weekdaysNarrow:["P","E","T","K","N","R","L"],cancelBtnText:"Tühista",cancelLabel:"Tühista",okLabel:"OK",twelveHour:!1};default:return{firstDay:1,title:"Valitse päivämäärä",monthsFull:["tammikuu","helmikuu","maaliskuu","huhtikuu","toukokuu","kesäkuu","heinäkuu","elokuu","syyskuu","lokakuu","marraskuu","joulukuu"],monthsShort:["tammi","helmi","maalis","huhti","touko","kesä","heinä","elo","syys","loka","marras","joulu"],weekdaysFull:["sunnuntai","maanantai","tiistai","keskiviikko","torstai","perjantai","lauantai"],weekdaysShort:["su","ma","ti","ke","to","pe","la"],weekdaysNarrow:["S","M","T","K","T","P","L"],cancelBtnText:"Peruuta",clearLabel:"Poista",cancelLabel:"Peruuta",okLabel:"Ok",twelveHour:!1}}}),ae=w(()=>`dt-${v.value}`);d(!1);const te=w(()=>v.value.split("-")[0]);k(te,s=>{console.log(`Hetke keelevalik - ${s}`),W.value=s},{immediate:!0}),pe(async()=>{se()});const se=async()=>{try{await Me(),console.log("Map is inited in Recipient form! ✅");const s={lat:50.064192,lng:-130.605469},e={north:s.lat+.1,south:s.lat-.1,east:s.lng+.1,west:s.lng-.1},a=document.getElementById("location"),m={bounds:e,componentRestrictions:{country:"fi"},fields:["address_components","geometry","icon","name","formatted_address"],strictBounds:!1},S=new google.maps.places.Autocomplete(a,m);S.addListener("place_changed",()=>{let g=S.getPlace();L.value=g.geometry.location.lat(),H.value=g.geometry.location.lng(),t.address=g.formatted_address,console.log(g)})}catch(s){console.error("Google Maps failed to load ❌",s),mapsError.value=!0}},oe=async()=>{navigator.geolocation&&await navigator.geolocation.getCurrentPosition(s=>{const{latitude:e,longitude:a}=s.coords;L.value=e,H.value=a,le(e,a)})},le=(s,e)=>{Te.get("https://maps.googleapis.com/maps/api/geocode/json?latlng="+s+","+e+"&key=AIzaSyDt2YXE5tk0J72JgqnH3DTD7MeoqbbWBmU").then(a=>{a.data.error_message?console.log(a.data.error_message):(t.address=a.data.results[1].formatted_address,console.log("Address now "+t.address))}).catch(a=>{console.log(a.message)})},ne=()=>{x.value=!0,oe()},ie=()=>{x.value=!1,t.address=""},R=s=>{const e=s?.match(/^(\d{2})\/(\d{2})\/(\d{4}),?\s+(\d{2}):(\d{2})$/);if(!e)return null;const[,a,m,S,g,de]=e.map(Number);return new Date(S,m-1,a,g,de)},re=async()=>{if(P()){console.log("Header - "+t.orderHeader);const s=R(t.dateTime);let e;s?(E.value=s,console.log("DATE - "+s),e=s.getTime(),console.log("Milliseconds:",e)):console.log("Invalid date string");const a={created:s,created_ms:e,dateStr:t.dateTime,header:t.orderHeader,agreement:F.value,address:t.address,latitude:L.value,longitude:H.value,zone:T.value!==""?T.value:0,professional:t.profession.label,isIncludeOffers:!0,description:t.explanation,status:"notSeen"},m=await xe.addRecipient($.user.id,a);m&&f("createBookingMultiple",m)}else{console.log("Midagi puudu:",t);const s=R(t.dateTime);let e;s?(E.value=s,e=s.getTime(),console.log("Milliseconds:",e)):console.log("Invalid date string"),D.value="Kentät pitäisi huomioida!",M.value=!0}};return(s,e)=>(p(),c("div",null,[i(l(ce),null,{default:r(()=>[i(Le,{modelValue:N.value,"onUpdate:modelValue":e[0]||(e[0]=a=>N.value=a),"toast-name":X.value,"icon-state":Y.value,text:ee.value},null,8,["modelValue","toast-name","icon-state","text"]),n("div",He,[i(l(q),{modelValue:M.value,"onUpdate:modelValue":e[2]||(e[2]=a=>M.value=a),autohide:"",delay:3e3,stacking:!1,position:"top-center",toast:"danger",icon:"fas fa-exclamation-circle fa-lg me-2"},{title:r(()=>[...e[12]||(e[12]=[b("VIRHE LOMAKEELLA! ",-1)])]),small:r(()=>[...e[13]||(e[13]=[])]),default:r(()=>[n("button",{type:"button",style:{visibility:"hidden"},class:"btn-close ms-auto","aria-label":"Close",onClick:e[1]||(e[1]=(...a)=>s.hideError&&s.hideError(...a))}),b(" "+u(D.value),1)]),_:1},8,["modelValue"])]),n("div",Ce,[n("p",Ae,u(l(V)("client_form_offersOrQuickSolution")),1),n("form",{novalidate:"",onSubmit:ve(re,["prevent"]),autocomplete:"off",style:{padding:"5px"}},[i(l(C),null,{default:r(()=>[i(l(y),{col:"10"},{default:r(()=>[n("div",Oe,[n("div",null,[i(l(Se),{style:ge([{width:"100%"},s.isNoPro?"color: pink; border: 1px solid red;":"color: white;"]),modelValue:t.profession,"onUpdate:modelValue":e[3]||(e[3]=a=>t.profession=a),options:l(Z),filter:"",optionLabel:"label",optionGroupLabel:"label",optionGroupChildren:"items",placeholder:"Valitse ammattilainen *",class:"w-full md:w-[30rem]"},{value:r(a=>[a.value?(p(),c("div",Be,[n("div",null,u(a.value.label),1)])):(p(),c("span",De,u(a.placeholder),1))]),optiongroup:r(a=>[n("div",Ie,[n("i",{class:A(a.option.icon),style:{"font-size":"17px",color:"cadetblue"}},null,2),e[14]||(e[14]=b("    ",-1)),n("span",null,u(a.option.label),1)])]),_:1},8,["modelValue","options","style"])]),o.profession?(p(),c("span",Ee,u(o.profession),1)):h("",!0)])]),_:1}),i(l(y),{col:"2"},{default:r(()=>[n("div",{style:{width:"100%"},onClick:e[4]||(e[4]=a=>l(_).push("/pro-around"))},[n("img",{class:"mapGif",src:l(Q),alt:"from_map"},null,8,Ne)])]),_:1})]),_:1}),n("div",Ke,[i(l(O),{label:"Syötä tilauksen avainsana *",modelValue:t.orderHeader,"onUpdate:modelValue":e[5]||(e[5]=a=>t.orderHeader=a),size:"lg",invalidFeedback:"Ole hyvä ja kirjoita avainsana.",validFeedback:"Ok!",required:""},null,8,["modelValue"]),o.orderHeader?(p(),c("span",Re,u(o.orderHeader),1)):h("",!0)]),i(l(C),null,{default:r(()=>[i(l(y),{lg:"6"},{default:r(()=>[n("div",{class:A([{hideInput:!t.address&&x.value},"field-wrapper"]),style:{width:"100%"}},[n("div",ze,[i(l(O),{size:"lg",id:"location",modelValue:t.address,"onUpdate:modelValue":e[6]||(e[6]=a=>t.address=a),label:"Anna osoite",placeholder:"",wrapperClass:"form-outline flex-grow-3",inputClass:"ps-0","aria-describedby":"button-addon2"},null,8,["modelValue"]),i(l(U),{type:"button",style:{border:"1px solid #ddd"}},{default:r(()=>[i(l(ye),{size:"2x",onClick:e[7]||(e[7]=a=>t.address?ie():ne())},{default:r(()=>[n("i",{class:A(t.address?"fas fa-times":"fas fa-search-location")},null,2)]),_:1})]),_:1})]),o.address?(p(),c("span",Ue,u(o.address),1)):h("",!0)],2),ke(n("div",Je,[i(l(be),{grow:"",color:"info"})],512),[[he,!t.address&&x.value]])]),_:1}),i(l(y),null,{default:r(()=>[n("div",qe,[i(l(O),{type:"text",value:I.value,onInput:G.value,label:"Anna säde mistä maksimi haet ammattilaista - km",modelValue:T.value,"onUpdate:modelValue":e[8]||(e[8]=a=>T.value=a),size:"lg"},null,8,["value","onInput","modelValue"])])]),_:1})]),_:1}),n("div",null,[e[15]||(e[15]=n("p",{style:{"text-align":"left"}},"Mihin aikaan tarvitset ammattilaista?",-1)),n("div",Pe,[(p(),J(l(we),{size:"lg",label:"Valitse tehtävän päivämäärä ja aika",modelValue:t.dateTime,"onUpdate:modelValue":e[9]||(e[9]=a=>t.dateTime=a),datepicker:{...K.value},timepicker:{...K.value,hoursFormat:24},key:ae.value,disablePast:""},null,8,["modelValue","datepicker","timepicker"])),o.dateTime?(p(),c("span",Ge,u(o.dateTime),1)):h("",!0)])]),e[17]||(e[17]=n("div",{style:{color:"#fff"}},null,-1)),n("div",We,[i(l(Ve),{label:"Vastaukset voi lähettää sähköpostiin!",name:"agreement_as_client",modelValue:F.value,"onUpdate:modelValue":e[10]||(e[10]=a=>F.value=a),value:"true",wrapperClass:"mb-4"},null,8,["modelValue"])]),i(l(C),null,{default:r(()=>[i(l(y),{lg:"6"},{default:r(()=>[n("div",$e,[i(l(_e),{maxlength:"70",label:"Kuvaus tilauksen sisällöstä *",rows:"3",modelValue:t.explanation,"onUpdate:modelValue":e[11]||(e[11]=a=>t.explanation=a),invalidFeedback:"Ole hyvä ja kirjoita tehtävän kuvaus.",validFeedback:"Ok!",required:""},null,8,["modelValue"]),o.explanation?(p(),c("span",Ze,u(o.explanation),1)):h("",!0),n("span",Qe,u(t.explanation.length)+" / 70",1)])]),_:1}),i(l(y),{lg:"6"})]),_:1}),i(l(U),{color:"primary",size:"lg",style:{"margin-top":"13px","margin-bottom":"20px"},type:"submit"},{default:r(()=>[...e[16]||(e[16]=[b("Submit",-1)])]),_:1})],32)])]),_:1})]))}});export{oa as default};
