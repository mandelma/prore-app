import{B as w,i as G,o as p,w as d,h as b,x as u,e as s,l as W,u as fe,C as J,t as k,r as i,k as ve,D as ge,c,b as r,J as ke,f as ye,g as n,p as be,Z as C,G as y,y as h,E as he,z as A,v as O,F as we,m as P,n as Te,T as Ve,H as _e,L as xe,M as Se,I as Me,K as je,s as Fe}from"./index-DW7v6QT8.js";import{s as Le,o as He}from"./index-xtpbSwDa.js";import{l as Ce}from"./loadGoogleMap-DZ-zVA3K.js";/* empty css                                                                         *//* empty css                                                                      */import"./index-93e-Jyro.js";const Ae="/assets/map-BDksWA_C.gif",Oe=Object.assign({name:"HandleToast"},{__name:"ToastHandler",props:{modelValue:{type:Boolean,default:!1},toastName:{type:String,default:""},iconState:{type:String,default:""},text:{type:String,default:""}},emits:["update:modelValue"],setup(B,{emit:M}){const f=B,v=M,T=w({get:()=>f.modelValue,set:V=>v("update:modelValue",V)});return(V,t)=>(p(),G(s(W),{modelValue:T.value,"onUpdate:modelValue":t[0]||(t[0]=l=>T.value=l),autohide:"",delay:3e3,stacking:!1,position:"top-center",color:f.toastName,icon:f.iconState},{title:d(()=>[...t[1]||(t[1]=[b("PROKEIKKATORI",-1)])]),default:d(()=>[b(" "+u(f.text),1)]),_:1},8,["modelValue","color","icon"]))}}),Be={style:{padding:"13px 0 20px 0"}},Ie={class:"form-card"},De={style:{"margin-top":"10px",color:"#00BFFFFF"}},Ee={class:"field-wrapper"},Ne={key:0},Ke={key:1},Re={class:"flex items-center gap-2"},ze={key:0,class:"field-footer"},Ue=["src"],Je={class:"field-wrapper"},Pe={key:0,class:"field-footer"},Ge={class:"input-group"},We={key:0,class:"field-footer"},$e={style:{"text-align":"center","padding-bottom":"27px"}},qe={class:"field-wrapper"},Ze={class:"field-wrapper"},Qe={key:0,class:"field-footer"},Xe={class:"field-wrapper"},Ye={class:"field-wrapper"},ea={key:0,class:"field-footer"},aa={class:"message-counter"},ra=Object.assign({name:"recipient-form"},{__name:"RecipientForm",emits:["createBookingMultiple"],setup(B,{emit:M}){const f=M,{locale:v,t:T}=fe(),V=ye(),t=J({profession:"",orderHeader:"",address:"",dateTime:"",explanation:""}),l=J({}),$=()=>(l.profession=t.profession?"":"Ammatti on pakollinen kenttä",l.orderHeader=t.orderHeader?"":"Avainsana on pakollinen kenttä",l.address=t.address?"":"Osoite on pakollinen kenttä",l.dateTime=t.dateTime?"":"Päivämäära on pakollinen kenttä",l.explanation=t.explanation?"":"Kuvaus on pakollinen kentta",!l.profession&&!l.orderHeader&&!l.address&&!l.dateTime&&!l.explanation);k(()=>t.profession,()=>l.profession=""),k(()=>t.orderHeader,()=>l.orderHeader=""),k(()=>t.address,()=>l.address=""),k(()=>t.dateTime,()=>l.dateTime=""),k(()=>t.explanation,()=>l.explanation="");const q=i(o=>{let a=o.target.value.replace(/[^0-9.]/g,"");const m=a.split(".");m.length>2&&(a=m[0]+"."+m.slice(1).join("")),a.startsWith(".")&&(a="0"+a),o.target.value=a,E.value=a});i(50);const j=i(!1),I=i(""),Z=i(""),D=ve(),E=i(""),_=i(!1);i("");const F=i(!1),Q=He,X=Ae,N=i(!1),x=i(""),L=i(null),H=i(null),K=i(null),R=i(!1),Y=i(""),ee=i(""),ae=i(""),te=i(!1),oe=i(""),le=i("");i(""),w(()=>({en:"en",fi:"fi",sv:"sv",et:"et"})[v.value]??"fi");const z=w(()=>{switch(v.value){case"en":return{firstDay:0,title:"Select date",monthsFull:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdaysFull:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Su","Mo","Tu","We","Th","Fr","Sa"],weekdaysNarrow:["S","M","T","W","T","F","S"],cancelBtnText:"Cancel",cancelLabel:"Cansel",okLabel:"OK",twelveHour:!0};case"sv":return{firstDay:1,title:"Rootsi date",monthsFull:["januari","februari","mars","april","maj","juni","juli","augusti","september","oktober","november","december"],monthsShort:["jan","feb","mar","apr","maj","jun","jul","aug","sep","okt","nov","dec"],weekdaysFull:["söndag","måndag","tisdag","onsdag","torsdag","fredag","lördag"],weekdaysShort:["sö","må","ti","on","to","fr","lö"],weekdaysNarrow:["S","M","T","O","T","F","L"],cancelBtnText:"Avbryt",cancelLabel:"Avbryt",okLabel:"OK",twelveHour:!1};case"et":return{firstDay:1,title:"Vali kuupäev",monthsFull:["jaanuar","veebruar","märts","aprill","mai","juuni","juuli","august","september","oktoober","november","detsember"],monthsShort:["jaan","veebr","märts","apr","mai","juuni","juuli","aug","sept","okt","nov","dets"],weekdaysFull:["pühapäev","esmaspäev","teisipäev","kolmapäev","neljapäev","reede","laupäev"],weekdaysShort:["P","E","T","K","N","R","L"],weekdaysNarrow:["P","E","T","K","N","R","L"],cancelBtnText:"Tühista",cancelLabel:"Tühista",okLabel:"OK",twelveHour:!1};default:return{firstDay:1,title:"Valitse päivämäärä",monthsFull:["tammikuu","helmikuu","maaliskuu","huhtikuu","toukokuu","kesäkuu","heinäkuu","elokuu","syyskuu","lokakuu","marraskuu","joulukuu"],monthsShort:["tammi","helmi","maalis","huhti","touko","kesä","heinä","elo","syys","loka","marras","joulu"],weekdaysFull:["sunnuntai","maanantai","tiistai","keskiviikko","torstai","perjantai","lauantai"],weekdaysShort:["su","ma","ti","ke","to","pe","la"],weekdaysNarrow:["S","M","T","K","T","P","L"],cancelBtnText:"Peruuta",clearLabel:"Poista",cancelLabel:"Peruuta",okLabel:"Ok",twelveHour:!1}}}),se=w(()=>`dt-${v.value}`);i(!1);const ne=w(()=>v.value.split("-")[0]);k(ne,o=>{console.log(`Hetke keelevalik - ${o}`),Z.value=o},{immediate:!0}),ge(async()=>{ie()});const ie=async()=>{N.value=!1;try{await Ce(),console.log("Map is inited in Recipient form! ✅");const o={lat:50.064192,lng:-130.605469},e={north:o.lat+.1,south:o.lat-.1,east:o.lng+.1,west:o.lng-.1},a=document.getElementById("location"),m={bounds:e,componentRestrictions:{country:"fi"},fields:["address_components","geometry","icon","name","formatted_address"],strictBounds:!1},S=new google.maps.places.Autocomplete(a,m);S.addListener("place_changed",()=>{let g=S.getPlace();L.value=g.geometry.location.lat(),H.value=g.geometry.location.lng(),t.address=g.formatted_address,console.log(g)})}catch(o){console.error("Google Maps failed to load ❌",o),N.value=!0,te.value=!0,oe.value="danger",le.value="fas fa-check fa-lg me-2"}},re=async()=>{navigator.geolocation&&await navigator.geolocation.getCurrentPosition(o=>{const{latitude:e,longitude:a}=o.coords;L.value=e,H.value=a,de(e,a)})},de=(o,e)=>{Fe.get("https://maps.googleapis.com/maps/api/geocode/json?latlng="+o+","+e+"&key=AIzaSyDt2YXE5tk0J72JgqnH3DTD7MeoqbbWBmU").then(a=>{a.data.error_message?console.log(a.data.error_message):(t.address=a.data.results[1].formatted_address,console.log("Address now "+t.address))}).catch(a=>{console.log(a.message)})},ue=()=>{_.value=!0,re()},me=()=>{_.value=!1,t.address=""},U=o=>{const e=o?.match(/^(\d{2})\/(\d{2})\/(\d{4}),?\s+(\d{2}):(\d{2})$/);if(!e)return null;const[,a,m,S,g,ce]=e.map(Number);return new Date(S,m-1,a,g,ce)},pe=async()=>{if($()){console.log("Header - "+t.orderHeader);const o=U(t.dateTime);let e;o?(K.value=o,console.log("DATE - "+o),e=o.getTime(),console.log("Milliseconds:",e)):console.log("Invalid date string");const a={author_id:D.user.id,created:o,created_ms:e,dateStr:t.dateTime,header:t.orderHeader,agreement:F.value,address:t.address,latitude:L.value,longitude:H.value,zone:x.value!==""?x.value:0,professional:t.profession.label,isIncludeOffers:!0,description:t.explanation,status:"notSeen"},m=await je.addRecipient(D.user.id,a);m&&f("createBookingMultiple",m)}else{console.log("Midagi puudu:",t);const o=U(t.dateTime);let e;o?(K.value=o,e=o.getTime(),console.log("Milliseconds:",e)):console.log("Invalid date string"),I.value="Kentät pitäisi huomioida!",j.value=!0}};return(o,e)=>(p(),c("div",null,[r(s(ke),null,{default:d(()=>[r(Oe,{modelValue:R.value,"onUpdate:modelValue":e[0]||(e[0]=a=>R.value=a),"toast-name":Y.value,"icon-state":ee.value,text:ae.value},null,8,["modelValue","toast-name","icon-state","text"]),n("div",Be,[r(s(W),{modelValue:j.value,"onUpdate:modelValue":e[2]||(e[2]=a=>j.value=a),autohide:"",delay:3e3,stacking:!1,position:"top-center",toast:"danger",icon:"fas fa-exclamation-circle fa-lg me-2"},{title:d(()=>[...e[12]||(e[12]=[b("VIRHE LOMAKEELLA! ",-1)])]),small:d(()=>[...e[13]||(e[13]=[])]),default:d(()=>[n("button",{type:"button",style:{visibility:"hidden"},class:"btn-close ms-auto","aria-label":"Close",onClick:e[1]||(e[1]=(...a)=>o.hideError&&o.hideError(...a))}),b(" "+u(I.value),1)]),_:1},8,["modelValue"])]),n("div",Ie,[n("p",De,u(s(T)("client_form_offersOrQuickSolution")),1),n("form",{novalidate:"",onSubmit:be(pe,["prevent"]),autocomplete:"off",style:{padding:"5px"}},[r(s(C),null,{default:d(()=>[r(s(y),{col:"10"},{default:d(()=>[n("div",Ee,[n("div",null,[r(s(Le),{style:he([{width:"100%"},o.isNoPro?"color: pink; border: 1px solid red;":"color: white;"]),modelValue:t.profession,"onUpdate:modelValue":e[3]||(e[3]=a=>t.profession=a),options:s(Q),filter:"",optionLabel:"label",optionGroupLabel:"label",optionGroupChildren:"items",placeholder:"Valitse ammattilainen *",class:"w-full md:w-[30rem]"},{value:d(a=>[a.value?(p(),c("div",Ne,[n("div",null,u(a.value.label),1)])):(p(),c("span",Ke,u(a.placeholder),1))]),optiongroup:d(a=>[n("div",Re,[n("i",{class:A(a.option.icon),style:{"font-size":"17px",color:"cadetblue"}},null,2),e[14]||(e[14]=b("    ",-1)),n("span",null,u(a.option.label),1)])]),_:1},8,["modelValue","options","style"])]),l.profession?(p(),c("span",ze,u(l.profession),1)):h("",!0)])]),_:1}),r(s(y),{col:"2"},{default:d(()=>[n("div",{style:{width:"100%"},onClick:e[4]||(e[4]=a=>s(V).push("/pro-around"))},[n("img",{class:"mapGif",src:s(X),alt:"from_map"},null,8,Ue)])]),_:1})]),_:1}),n("div",Je,[r(s(O),{label:"Syötä tilauksen avainsana *",modelValue:t.orderHeader,"onUpdate:modelValue":e[5]||(e[5]=a=>t.orderHeader=a),size:"lg",invalidFeedback:"Ole hyvä ja kirjoita avainsana.",validFeedback:"Ok!",required:""},null,8,["modelValue"]),l.orderHeader?(p(),c("span",Pe,u(l.orderHeader),1)):h("",!0)]),r(s(C),null,{default:d(()=>[r(s(y),{lg:"6"},{default:d(()=>[n("div",{class:A([{hideInput:!t.address&&_.value},"field-wrapper"]),style:{width:"100%"}},[n("div",Ge,[r(s(O),{size:"lg",id:"location",modelValue:t.address,"onUpdate:modelValue":e[6]||(e[6]=a=>t.address=a),label:"Anna osoite",placeholder:"",wrapperClass:"form-outline flex-grow-3",inputClass:"ps-0","aria-describedby":"button-addon2"},null,8,["modelValue"]),r(s(P),{type:"button",style:{border:"1px solid #ddd"}},{default:d(()=>[r(s(Te),{size:"2x",onClick:e[7]||(e[7]=a=>t.address?me():ue())},{default:d(()=>[n("i",{class:A(t.address?"fas fa-times":"fas fa-search-location")},null,2)]),_:1})]),_:1})]),l.address?(p(),c("span",We,u(l.address),1)):h("",!0)],2),we(n("div",$e,[r(s(Ve),{grow:"",color:"info"})],512),[[_e,!t.address&&_.value]])]),_:1}),r(s(y),null,{default:d(()=>[n("div",qe,[r(s(O),{type:"text",value:E.value,onInput:q.value,label:"Anna säde mistä maksimi haet ammattilaista - km",modelValue:x.value,"onUpdate:modelValue":e[8]||(e[8]=a=>x.value=a),size:"lg"},null,8,["value","onInput","modelValue"])])]),_:1})]),_:1}),n("div",null,[e[15]||(e[15]=n("p",{style:{"text-align":"left"}},"Mihin aikaan tarvitset ammattilaista?",-1)),n("div",Ze,[(p(),G(s(xe),{size:"lg",label:"Valitse tehtävän päivämäärä ja aika",modelValue:t.dateTime,"onUpdate:modelValue":e[9]||(e[9]=a=>t.dateTime=a),toggleButton:!1,inputToggle:"",datepicker:{...z.value},timepicker:{...z.value,hoursFormat:24},key:se.value,disablePast:""},null,8,["modelValue","datepicker","timepicker"])),l.dateTime?(p(),c("span",Qe,u(l.dateTime),1)):h("",!0)])]),e[17]||(e[17]=n("div",{style:{color:"#fff"}},null,-1)),n("div",Xe,[r(s(Se),{label:"Vastaukset voi lähettää sähköpostiin!",name:"agreement_as_client",modelValue:F.value,"onUpdate:modelValue":e[10]||(e[10]=a=>F.value=a),value:"true",wrapperClass:"mb-4"},null,8,["modelValue"])]),r(s(C),null,{default:d(()=>[r(s(y),{lg:"6"},{default:d(()=>[n("div",Ye,[r(s(Me),{maxlength:"70",label:"Kuvaus tilauksen sisällöstä *",rows:"3",modelValue:t.explanation,"onUpdate:modelValue":e[11]||(e[11]=a=>t.explanation=a),invalidFeedback:"Ole hyvä ja kirjoita tehtävän kuvaus.",validFeedback:"Ok!",required:""},null,8,["modelValue"]),l.explanation?(p(),c("span",ea,u(l.explanation),1)):h("",!0),n("span",aa,u(t.explanation.length)+" / 70",1)])]),_:1}),r(s(y),{lg:"6"})]),_:1}),r(s(P),{color:"primary",size:"lg",style:{"margin-top":"13px","margin-bottom":"20px"},type:"submit"},{default:d(()=>[...e[16]||(e[16]=[b("Lähetä tilaus",-1)])]),_:1})],32)])]),_:1})]))}});export{ra as default};
