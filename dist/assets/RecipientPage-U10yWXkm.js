import{u as K,r as f,P as M,aZ as Z,Q as V,i as c,o,w as s,e,J as j,f as A,b as a,c as y,l as D,g as i,h as p,x as u,Z as B,G as _,N as G,O as H,y as C,m as h,z as J,b4 as L,I as F}from"./index-DW7v6QT8.js";import W from"./RecipientContent-BWKgzhPF.js";/* empty css                                                                      */import{_ as X}from"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css                                                                         */const Y={key:0},ee={key:1},te={class:"client-header"},le={key:0,class:"client-orders"},se={id:"info-block-confirmed"},ne={class:"file-marker"},oe={class:"box-title-confirmed"},ae={class:"box-contents-confirmed"},ie={class:"booking_time"},re={key:0},de={style:{"margin-top":"23px"}},ue=Object.assign({name:"recipient-page"},{__name:"RecipientPage",props:{},setup(ce){const{t:r}=K(),T=A();f(null);const m=f(!1),x=f(null),k=M(),I=Z(),O=f(!1),w=f("TEST"),v=f(!1),R=f(null),g=f(""),{bookings:N}=V(k),{userId:fe}=V(I),$=(l,n)=>{console.log("Booking id - "+l),console.log("Booking title: "),m.value=!0,x.value=k.getBookingById(l)},z=(l,n)=>{console.log("Booking id is "+l),console.log("Offer id is "+n),x.value=k.getBookingById(l)},E=()=>{console.log("CANCEL"),m.value=!1},Q=()=>{console.log("OUT"),m.value=!1},b=l=>{m.value=!1,O.value=!0,w.value=`${l} vahvistettu`},P=l=>{console.log("Index, quit booking: "+l),R.value=l,v.value=!0},U=()=>{v.value=!1,g.value=""},q=async l=>{console.log("Quit bbb "+l.header),console.log("Selected booking pro user - "+l.ordered[0].user.id);const n=l.ordered[0].user.id,t=g.value,S=l.user.username;await k.removeConfirmedMapOffer(l);const d=`${l.user.username} peruutti tilauksen "${l.header}". Syyksi ilmoitettu: ${t}!`;await I.addNotification(l.id,S,d,n)};return(l,n)=>(o(),c(e(j),null,{default:s(()=>[a(e(D),{stacking:!1,autohide:"",delay:3e3,modelValue:O.value,"onUpdate:modelValue":n[1]||(n[1]=t=>O.value=t),toast:"success",icon:"fas fa-check fa-lg me-2"},{title:s(()=>[...n[4]||(n[4]=[p(" PROKEIKKATORI ",-1)])]),default:s(()=>[i("button",{type:"button",style:{visibility:"hidden"},class:"btn-close ms-auto","aria-label":"Close",onClick:n[0]||(n[0]=(...t)=>l.hideError&&l.hideError(...t))}),p(" "+u(w.value),1)]),_:1},8,["modelValue"]),m.value?(o(),y("div",Y,[a(W,{booking:x.value,onUpdateOfferState:z,onCancelRecipientContent:E,onOutHere:Q,onCanselRecipientContentConfirmed:b},null,8,["booking"])])):(o(),y("div",ee,[i("div",null,[a(e(B),null,{default:s(()=>[a(e(_),{md:"8"}),a(e(_),{style:{padding:"20px 5px 20px 5px",color:"cadetblue"},md:"4"},{default:s(()=>[i("h3",te,u(e(r)("recipient_panel_you_have")+" "+e(N).length+" "+e(r)("recipient_panel_open_orders")),1)]),_:1})]),_:1}),(o(!0),y(G,null,H(e(N),(t,S)=>(o(),c(e(B),{key:S,class:"bookings"},{default:s(()=>[t.status!=="confirmed"?(o(),y("div",le,[i("aside",se,[i("section",ne,[i("div",null,[i("div",oe,u(t.isIncludeOffers?t.offers.length>0?t.offers.length+" "+e(r)("offerCountNotification"):e(r)("recipient_panel_no_offers"):e(r)("recipient_panel_order_is_pending")),1),i("div",ae,[a(e(B),null,{default:s(()=>[a(e(_),null,{default:s(()=>[i("p",ie,u(t.date),1)]),_:2},1024),a(e(_),null,{default:s(()=>[p(u(t.header),1)]),_:2},1024),a(e(_),{lg:"4"},{default:s(()=>[t.isIncludeOffers?(o(),c(e(h),{key:1,rounded:"",color:"primary",size:"lg",onClick:d=>$(t.id,t),style:{width:"100%"}},{default:s(()=>[i("span",{class:J({date_expired:t.created_ms-new Date().getTime()<=0})},u(e(r)("recipient_panel_order")),3),t.offers.filter(d=>d.isNewOffer).length>0?(o(),c(e(L),{key:0,color:"danger",class:"ms-2"},{default:s(()=>[p(u(t.offers.filter(d=>d.isNewOffer).length),1)]),_:2},1024)):C("",!0)]),_:2},1032,["onClick"])):(o(),y("div",re,[R.value===t.id&&v.value?(o(),c(e(h),{key:0,style:{"margin-bottom":"13px"},outline:"danger",block:"",size:"lg",onClick:U},{default:s(()=>[...n[5]||(n[5]=[p(" Poistu ",-1)])]),_:1})):(o(),c(e(h),{key:1,color:"danger",rounded:"",onClick:d=>P(t.id)},{default:s(()=>[p(u(e(r)("recipient_panel_quit_order")),1)]),_:1},8,["onClick"]))]))]),_:2},1024)]),_:2},1024),R.value===t.id&&!t.isIncludeOffers?(o(),c(e(B),{key:0},{default:s(()=>[a(e(_),{lg:"8",style:{"text-align":"center"}},{default:s(()=>[v.value?(o(),c(e(F),{key:0,white:"",style:{},modelValue:g.value,"onUpdate:modelValue":n[2]||(n[2]=d=>g.value=d),label:e(r)("recipient_panel_give_reason"),rows:"3"},null,8,["modelValue","label"])):C("",!0)]),_:1}),a(e(_),{lg:"4"},{default:s(()=>[v.value&&g.value.length>3?(o(),c(e(h),{key:0,block:"",color:"success",size:"lg>",style:{"margin-top":"10px"},onClick:d=>q(t)},{default:s(()=>[p(u(e(r)("recipient_panel_confirm_quit")),1)]),_:1},8,["onClick"])):C("",!0)]),_:2},1024)]),_:2},1024)):C("",!0)])])])])])):C("",!0)]),_:2},1024))),128)),i("div",de,[a(e(h),{outline:"info",block:"",size:"lg",onClick:n[3]||(n[3]=t=>e(T).push("/client-form"))},{default:s(()=>[p(u(e(r)("recipient_panel_new_order")),1)]),_:1})])])]))]),_:1}))}}),ye=X(ue,[["__scopeId","data-v-cd26e836"]]);export{ye as default};
