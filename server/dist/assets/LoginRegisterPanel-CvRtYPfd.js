import{g as K,r as l,h as O,i as S,j as R,o as k,w as i,b as p,f as w,a as o,u as s,l as H,t as U,k as J,c as _,m as L,v as y,e as E,p as N,M as X,J as h,q as Z,s as q,X as D,U as P}from"./index-0xjDgJIs.js";import G from"./LoginForm-DjL0D0hz.js";const Q="/api/users",W=async j=>(await K.post(`${Q}`,j)).data,Y={addUser:W},ee={style:{padding:"13px 0 20px 0"}},ae={class:"input-group mb-3"},le={key:0,style:{color:"palevioletred"}},se={class:"input-group mb-3"},oe={key:1,style:{color:"palevioletred"}},te={class:"form-actions"},re=Object.assign({name:"RegisterForm"},{__name:"RegisterForm",setup(j){const n=l(""),d=l(""),r=l(""),m=l(""),t=l(""),v=l(""),g=l(!0),f=l(!1),x=l(!1),u=l(!1),V=l(""),C=l("");l(""),l(""),l(""),l("");const c=l(""),$=O(),z=()=>{u.value=!1},A=()=>{console.log("Password is toggled"),f.value=!f.value},F=()=>{console.log("Password confirm is toggled!"),x.value=!x.value},T=()=>{/^(?=.*[A-Z])(?=.*\d)(?=.*[!@#$%^&*()_\-+=\[\]{};':"\\|,.<>/?]).{8,}$/.test(t.value)?V.value="":V.value="Salasanan on oltava vähintään 8 merkkiä pitkä ja sen on sisällettävä iso kirjain, numero ja erikoismerkki."},I=()=>{/^(?=.*[A-Z])(?=.*\d)(?=.*[!@#$%^&*()_\-+=\[\]{};':"\\|,.<>/?]).{8,}$/.test(v.value)?C.value="":C.value="Salasanan on oltava vähintään 8 merkkiä pitkä ja sen on sisällettävä iso kirjain, numero ja erikoismerkki."};S(t,b=>{T()}),S(v,b=>{I()});const M=async()=>{const b={firstName:n.value,lastName:d.value,username:r.value,email:m.value,password:t.value};if(n.value!==""&&d.value!==""&&r.value!==""&&t.value!==""&&m.value!=="")if(r.value.length<4)u.value=!0,c.value="Username must be longer than 4 characters!";else if(!/^[^@]+@\w+(\.\w+)+\w$/.test(m.value))u.value=!0,c.value="Anna kelvollinen sähköpostiosoite!";else if(t.value!==v.value)u.value=!0,c.value="Salasana on oltava sama!";else{console.log("Uus kasutaja");const e=await Y.addUser(b);if(e.error==="username existing")u.value=!0,c.value="Käyttäjätunnus on jo olemassa! Vaihda käyttäjätunnus";else if(e.error==="email existing")u.value=!0,c.value="Antamasi sähköpostiosoite on jo olemassa!";else{console.log("registerFirstName "+n.value),console.log("registerLastName "+d.value),console.log("registerUsername "+r.value),console.log("registerPassword "+t.value),console.log("registerEmail "+m.value);const a=await Z.login({username:r.value,password:t.value});console.log("LOgin error: "+a.error),a.error!=="login error"?($.onLogin(a),B()):console.log("Error with login! "+a.error)}}else u.value=!0,c.value="Kaikki kentät ovat täytettävä!!"},B=()=>{console.log("registerFirstName "+n.value),console.log("registerLastName "+d.value),console.log("registerUsername "+r.value),console.log("registerPassword "+t.value),console.log("registerEmail "+m.value)};return(b,e)=>(k(),R(s(h),null,{default:i(()=>[p("div",ee,[o(s(H),{modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=a=>u.value=a),autohide:"",delay:3e3,stacking:!1,position:"top-center",toast:"danger",icon:"fas fa-exclamation-circle fa-lg me-2"},{title:i(()=>e[8]||(e[8]=[w(" TAPAHTUI VIRHE! ",-1)])),small:i(()=>e[9]||(e[9]=[])),default:i(()=>[p("button",{type:"button",style:{visibility:"hidden"},class:"btn-close ms-auto","aria-label":"Close",onClick:z}),w(" "+U(c.value),1)]),_:1},8,["modelValue"])]),w(" "+U(u.value)+" ",1),p("form",{class:"form-card",onSubmit:J(M,["prevent"]),autocomplete:"off"},[o(s(y),{type:"text",size:"lg",label:"Etunimi",id:"registerFirstName",modelValue:n.value,"onUpdate:modelValue":e[1]||(e[1]=a=>n.value=a),wrapperClass:"mb-4"},null,8,["modelValue"]),o(s(y),{type:"text",size:"lg",label:"Sukunimi",id:"registerLastName",modelValue:d.value,"onUpdate:modelValue":e[2]||(e[2]=a=>d.value=a),wrapperClass:"mb-4"},null,8,["modelValue"]),o(s(y),{type:"text",size:"lg",label:"käyttäjätunnus",id:"registerUsername",modelValue:r.value,"onUpdate:modelValue":e[3]||(e[3]=a=>r.value=a),wrapperClass:"mb-4"},null,8,["modelValue"]),o(s(y),{type:"text",size:"lg",label:"Email",id:"registerEmail",modelValue:m.value,"onUpdate:modelValue":e[4]||(e[4]=a=>m.value=a),wrapperClass:"mb-4"},null,8,["modelValue"]),p("div",ae,[o(s(y),{size:"lg",modelValue:t.value,"onUpdate:modelValue":e[5]||(e[5]=a=>t.value=a),type:f.value?"text":"password",label:"Anna salasana",wrapperClass:"form-outline flex-grow-3",inputClass:"ps-0","aria-describedby":"button-addon2"},null,8,["modelValue","type"]),o(s(E),{style:{border:"1px white"},type:"button"},{default:i(()=>[p("i",{class:N(f.value?"far fa-eye-slash":"far fa-eye"),style:{color:"#dddddd"},onClick:A},null,2)]),_:1})]),V.value&&t.value?(k(),_("p",le,U(V.value),1)):L("",!0),p("div",se,[o(s(y),{size:"lg",modelValue:v.value,"onUpdate:modelValue":e[6]||(e[6]=a=>v.value=a),type:x.value?"text":"password",label:"Toista salasana",wrapperClass:"form-outline flex-grow-3",inputClass:"ps-0","aria-describedby":"button-addon2"},null,8,["modelValue","type"]),o(s(E),{style:{border:"1px white"},type:"button"},{default:i(()=>[p("i",{class:N(x.value?"far fa-eye-slash":"far fa-eye"),style:{color:"#dddddd"},onClick:F},null,2)]),_:1})]),C.value&&v.value?(k(),_("p",oe,U(C.value),1)):L("",!0),o(s(X),{label:"Muista minut",size:"lg",id:"registerSubscribeCheck",modelValue:g.value,"onUpdate:modelValue":e[7]||(e[7]=a=>g.value=a),wrapperClass:"d-flex justify-content-center mb-4"},null,8,["modelValue"]),p("div",te,[o(s(E),{color:"primary",size:"lg",type:"submit",block:"",class:"mb-4",disabled:!!V.value},{default:i(()=>e[10]||(e[10]=[w(" Luo tili ",-1)])),_:1,__:[10]},8,["disabled"])])],32)]),_:1}))}}),ie={key:0},ne={key:1},me=Object.assign({name:"LoginRegister"},{__name:"LoginRegisterPanel",setup(j){const n=l("ex3-1"),d=l(!0),r=l(!1),m=()=>{d.value=!0,r.value=!1},t=()=>{r.value=!0,d.value=!1};return(v,g)=>(k(),R(s(h),null,{default:i(()=>[o(s(q),{modelValue:n.value,"onUpdate:modelValue":g[0]||(g[0]=f=>n.value=f)},{default:i(()=>[o(s(D),{pills:"",justify:"",tabsClasses:"mb-3",style:{margin:"auto"}},{default:i(()=>[o(s(P),{style:{"background-color":"#37546a",color:"#ddd"},onClick:m,tabId:"ex3-1",href:"ex3-1"},{default:i(()=>g[1]||(g[1]=[w("Kirjaudu",-1)])),_:1,__:[1]}),o(s(P),{style:{"background-color":"#223340",color:"#ddd"},onClick:t,tabId:"ex3-2",href:"ex3-2"},{default:i(()=>g[2]||(g[2]=[w("Registeröidy",-1)])),_:1,__:[2]})]),_:1})]),_:1},8,["modelValue"]),r.value?(k(),_("div",ie,[o(re,{"onRegister:data":v.handleRegister},null,8,["onRegister:data"])])):(k(),_("div",ne,[o(G,{"onLogin:data":v.userControl},null,8,["onLogin:data"])]))]),_:1}))}});export{me as default};
