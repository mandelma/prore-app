import{u as se,B as O,x as v,r as d,k as oe,C as _,D as le,c,o as p,b as n,w as r,e as o,J as ie,f as ne,g as l,l as re,h as T,y as u,p as de,Z as F,G as g,z as k,E as ue,A as M,v as L,F as me,m as E,n as pe,T as ce,H as fe,i as ve,L as ge,M as ke,I as ye,K as be,t as he}from"./index-B6-cChpL.js";import{s as we,o as _e}from"./index-DbDPPphc.js";import{l as Te}from"./loadGoogleMap-DZ-zVA3K.js";/* empty css                                                                         *//* empty css                                                                      */import"./index-93e-Jyro.js";const xe="/assets/map-BDksWA_C.gif",Ve={style:{padding:"13px 0 20px 0"}},Se={class:"form-card"},je={style:{"margin-top":"10px",color:"#00BFFFFF"}},Fe={class:"field-wrapper"},Me={key:0},Le={key:1},He={class:"flex items-center gap-2"},Ce={key:0,class:"field-footer"},Ae=["src"],De={class:"field-wrapper"},Be={key:0,class:"field-footer"},Oe={class:"input-group"},Ee={key:0,class:"field-footer"},Ie={style:{"text-align":"center","padding-bottom":"27px"}},Ne={class:"field-wrapper"},ze={class:"field-wrapper"},Ke={key:0,class:"field-footer"},Re={class:"field-wrapper"},Je={class:"field-wrapper"},qe={key:0,class:"field-footer"},Ue={class:"message-counter"},Ye=Object.assign({name:"recipient-form"},{__name:"RecipientForm",emits:["createBookingMultiple"],setup(Pe,{emit:I}){const N=I,{locale:y,t:z}=se(),K=ne(),t=O({profession:"",orderHeader:"",address:"",dateTime:"",explanation:""}),i=O({}),R=()=>(i.profession=t.profession?"":"Profession is required",i.orderHeader=t.orderHeader?"":"Header is required",i.address=t.address?"":"Address is required",i.dateTime=t.dateTime?"":"Date is required",i.explanation=t.explanation?"":"Kuvaus is required",!i.profession&&!i.orderHeader&&!i.address&&!i.dateTime&&!i.explanation);v(()=>t.profession,()=>i.profession=""),v(()=>t.orderHeader,()=>i.orderHeader=""),v(()=>t.address,()=>i.address=""),v(()=>t.dateTime,()=>i.dateTime=""),v(()=>t.explanation,()=>i.explanation="");const J=d(s=>{let a=s.target.value.replace(/[^0-9.]/g,"");const m=a.split(".");m.length>2&&(a=m[0]+"."+m.slice(1).join("")),a.startsWith(".")&&(a="0"+a),s.target.value=a,C.value=a});d(50);const x=d(!1),H=d(""),q=d(""),U=oe(),C=d(""),b=d(!1);d("");const V=d(!1),P=_e,G=xe,h=d(""),S=d(null),j=d(null),A=d(null);_(()=>({en:"en",fi:"fi",sv:"sv",et:"et"})[y.value]??"fi");const D=_(()=>{switch(y.value){case"en":return{firstDay:0,title:"Select date",monthsFull:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdaysFull:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Su","Mo","Tu","We","Th","Fr","Sa"],weekdaysNarrow:["S","M","T","W","T","F","S"],cancelBtnText:"Cancel",cancelLabel:"Cansel",okLabel:"OK",twelveHour:!0};case"sv":return{firstDay:1,title:"Rootsi date",monthsFull:["januari","februari","mars","april","maj","juni","juli","augusti","september","oktober","november","december"],monthsShort:["jan","feb","mar","apr","maj","jun","jul","aug","sep","okt","nov","dec"],weekdaysFull:["söndag","måndag","tisdag","onsdag","torsdag","fredag","lördag"],weekdaysShort:["sö","må","ti","on","to","fr","lö"],weekdaysNarrow:["S","M","T","O","T","F","L"],cancelBtnText:"Avbryt",cancelLabel:"Avbryt",okLabel:"OK",twelveHour:!1};case"et":return{firstDay:1,title:"Vali kuupäev",monthsFull:["jaanuar","veebruar","märts","aprill","mai","juuni","juuli","august","september","oktoober","november","detsember"],monthsShort:["jaan","veebr","märts","apr","mai","juuni","juuli","aug","sept","okt","nov","dets"],weekdaysFull:["pühapäev","esmaspäev","teisipäev","kolmapäev","neljapäev","reede","laupäev"],weekdaysShort:["P","E","T","K","N","R","L"],weekdaysNarrow:["P","E","T","K","N","R","L"],cancelBtnText:"Tühista",cancelLabel:"Tühista",okLabel:"OK",twelveHour:!1};default:return{firstDay:1,title:"Valitse päivämäärä",monthsFull:["tammikuu","helmikuu","maaliskuu","huhtikuu","toukokuu","kesäkuu","heinäkuu","elokuu","syyskuu","lokakuu","marraskuu","joulukuu"],monthsShort:["tammi","helmi","maalis","huhti","touko","kesä","heinä","elo","syys","loka","marras","joulu"],weekdaysFull:["sunnuntai","maanantai","tiistai","keskiviikko","torstai","perjantai","lauantai"],weekdaysShort:["su","ma","ti","ke","to","pe","la"],weekdaysNarrow:["S","M","T","K","T","P","L"],cancelBtnText:"Peruuta",clearLabel:"Poista",cancelLabel:"Peruuta",okLabel:"Ok",twelveHour:!1}}}),W=_(()=>`dt-${y.value}`);d(!1);const $=_(()=>y.value.split("-")[0]);v($,s=>{console.log(`Hetke keelevalik - ${s}`),q.value=s},{immediate:!0}),le(async()=>{Z()});const Z=async()=>{try{await Te(),console.log("Map is inited in Recipient form! ✅");const s={lat:50.064192,lng:-130.605469},e={north:s.lat+.1,south:s.lat-.1,east:s.lng+.1,west:s.lng-.1},a=document.getElementById("location"),m={bounds:e,componentRestrictions:{country:"fi"},fields:["address_components","geometry","icon","name","formatted_address"],strictBounds:!1},w=new google.maps.places.Autocomplete(a,m);w.addListener("place_changed",()=>{let f=w.getPlace();S.value=f.geometry.location.lat(),j.value=f.geometry.location.lng(),t.address=f.formatted_address,console.log(f)})}catch(s){console.error("Google Maps failed to load ❌",s),mapsError.value=!0}},Q=async()=>{navigator.geolocation&&await navigator.geolocation.getCurrentPosition(s=>{const{latitude:e,longitude:a}=s.coords;S.value=e,j.value=a,X(e,a)})},X=(s,e)=>{he.get("https://maps.googleapis.com/maps/api/geocode/json?latlng="+s+","+e+"&key=AIzaSyDt2YXE5tk0J72JgqnH3DTD7MeoqbbWBmU").then(a=>{a.data.error_message?console.log(a.data.error_message):(t.address=a.data.results[1].formatted_address,console.log("Address now "+t.address))}).catch(a=>{console.log(a.message)})},Y=()=>{b.value=!0,Q()},ee=()=>{b.value=!1,t.address=""},B=s=>{const e=s?.match(/^(\d{2})\/(\d{2})\/(\d{4}),?\s+(\d{2}):(\d{2})$/);if(!e)return null;const[,a,m,w,f,te]=e.map(Number);return new Date(w,m-1,a,f,te)},ae=async()=>{if(R()){console.log("Header - "+t.orderHeader);const s=B(t.dateTime);let e;s?(A.value=s,console.log("DATE - "+s),e=s.getTime(),console.log("Milliseconds:",e)):console.log("Invalid date string");const a={created:s,created_ms:e,dateStr:t.dateTime,header:t.orderHeader,agreement:V.value,address:t.address,latitude:S.value,longitude:j.value,zone:h.value!==""?h.value:0,professional:t.profession.label,isIncludeOffers:!0,description:t.explanation,status:"notSeen"},m=await be.addRecipient(U.user.id,a);m&&N("createBookingMultiple",m)}else{console.log("Midagi puudu:",t);const s=B(t.dateTime);let e;s?(A.value=s,e=s.getTime(),console.log("Milliseconds:",e)):console.log("Invalid date string"),H.value="Kentät pitäisi huomioida!",x.value=!0}};return(s,e)=>(p(),c("div",null,[n(o(ie),null,{default:r(()=>[l("div",Ve,[n(o(re),{modelValue:x.value,"onUpdate:modelValue":e[1]||(e[1]=a=>x.value=a),autohide:"",delay:3e3,stacking:!1,position:"top-center",toast:"danger",icon:"fas fa-exclamation-circle fa-lg me-2"},{title:r(()=>[...e[11]||(e[11]=[T("VIRHE LOMAKEELLA! ",-1)])]),small:r(()=>[...e[12]||(e[12]=[])]),default:r(()=>[l("button",{type:"button",style:{visibility:"hidden"},class:"btn-close ms-auto","aria-label":"Close",onClick:e[0]||(e[0]=(...a)=>s.hideError&&s.hideError(...a))}),T(" "+u(H.value),1)]),_:1},8,["modelValue"])]),l("div",Se,[l("p",je,u(o(z)("client_form_offersOrQuickSolution")),1),l("form",{novalidate:"",onSubmit:de(ae,["prevent"]),autocomplete:"off",style:{padding:"5px"}},[n(o(F),null,{default:r(()=>[n(o(g),{col:"10"},{default:r(()=>[l("div",Fe,[l("div",null,[n(o(we),{style:ue([{width:"100%"},s.isNoPro?"color: pink; border: 1px solid red;":"color: white;"]),modelValue:t.profession,"onUpdate:modelValue":e[2]||(e[2]=a=>t.profession=a),options:o(P),filter:"",optionLabel:"label",optionGroupLabel:"label",optionGroupChildren:"items",placeholder:"Valitse ammattilainen *",class:"w-full md:w-[30rem]"},{value:r(a=>[a.value?(p(),c("div",Me,[l("div",null,u(a.value.label),1)])):(p(),c("span",Le,u(a.placeholder),1))]),optiongroup:r(a=>[l("div",He,[l("i",{class:M(a.option.icon),style:{"font-size":"17px",color:"cadetblue"}},null,2),e[13]||(e[13]=T("    ",-1)),l("span",null,u(a.option.label),1)])]),_:1},8,["modelValue","options","style"])]),i.profession?(p(),c("span",Ce,u(i.profession),1)):k("",!0)])]),_:1}),n(o(g),{col:"2"},{default:r(()=>[l("div",{style:{width:"100%"},onClick:e[3]||(e[3]=a=>o(K).push("/pro-around"))},[l("img",{class:"mapGif",src:o(G),alt:"from_map"},null,8,Ae)])]),_:1})]),_:1}),l("div",De,[n(o(L),{label:"Syötä tilauksen avainsana *",modelValue:t.orderHeader,"onUpdate:modelValue":e[4]||(e[4]=a=>t.orderHeader=a),size:"lg",invalidFeedback:"Ole hyvä ja kirjoita avainsana.",validFeedback:"Ok!",required:""},null,8,["modelValue"]),i.orderHeader?(p(),c("span",Be,u(i.orderHeader),1)):k("",!0)]),n(o(F),null,{default:r(()=>[n(o(g),{lg:"6"},{default:r(()=>[l("div",{class:M([{hideInput:!t.address&&b.value},"field-wrapper"]),style:{width:"100%"}},[l("div",Oe,[n(o(L),{size:"lg",id:"location",modelValue:t.address,"onUpdate:modelValue":e[5]||(e[5]=a=>t.address=a),label:"Anna osoite",placeholder:"",wrapperClass:"form-outline flex-grow-3",inputClass:"ps-0","aria-describedby":"button-addon2"},null,8,["modelValue"]),n(o(E),{type:"button",style:{border:"1px solid #ddd"}},{default:r(()=>[n(o(pe),{size:"2x",onClick:e[6]||(e[6]=a=>t.address?ee():Y())},{default:r(()=>[l("i",{class:M(t.address?"fas fa-times":"fas fa-search-location")},null,2)]),_:1})]),_:1})]),i.address?(p(),c("span",Ee,u(i.address),1)):k("",!0)],2),me(l("div",Ie,[n(o(ce),{grow:"",color:"info"})],512),[[fe,!t.address&&b.value]])]),_:1}),n(o(g),null,{default:r(()=>[l("div",Ne,[n(o(L),{type:"text",value:C.value,onInput:J.value,label:"Anna säde mistä maksimi haet ammattilaista - km",modelValue:h.value,"onUpdate:modelValue":e[7]||(e[7]=a=>h.value=a),size:"lg"},null,8,["value","onInput","modelValue"])])]),_:1})]),_:1}),l("div",null,[e[14]||(e[14]=l("p",{style:{"text-align":"left"}},"Mihin aikaan tarvitset ammattilaista?",-1)),l("div",ze,[(p(),ve(o(ge),{size:"lg",label:"Valitse tehtävän päivämäärä ja aika",modelValue:t.dateTime,"onUpdate:modelValue":e[8]||(e[8]=a=>t.dateTime=a),datepicker:{...D.value},timepicker:{...D.value,hoursFormat:24},key:W.value,disablePast:""},null,8,["modelValue","datepicker","timepicker"])),i.dateTime?(p(),c("span",Ke,u(i.dateTime),1)):k("",!0)])]),e[16]||(e[16]=l("div",{style:{color:"#fff"}},null,-1)),l("div",Re,[n(o(ke),{label:"Vastaukset voi lähettää sähköpostiin!",name:"agreement_as_client",modelValue:V.value,"onUpdate:modelValue":e[9]||(e[9]=a=>V.value=a),value:"true",wrapperClass:"mb-4"},null,8,["modelValue"])]),n(o(F),null,{default:r(()=>[n(o(g),{lg:"6"},{default:r(()=>[l("div",Je,[n(o(ye),{maxlength:"70",label:"Kuvaus tilauksen sisällöstä *",rows:"3",modelValue:t.explanation,"onUpdate:modelValue":e[10]||(e[10]=a=>t.explanation=a),invalidFeedback:"Ole hyvä ja kirjoita tehtävän kuvaus.",validFeedback:"Ok!",required:""},null,8,["modelValue"]),i.explanation?(p(),c("span",qe,u(i.explanation),1)):k("",!0),l("span",Ue,u(t.explanation.length)+" / 70",1)])]),_:1}),n(o(g),{lg:"6"})]),_:1}),n(o(E),{color:"primary",size:"lg",style:{"margin-top":"13px","margin-bottom":"20px"},type:"submit"},{default:r(()=>[...e[15]||(e[15]=[T("Submit",-1)])]),_:1})],32)])]),_:1})]))}});export{Ye as default};
