import{_ as $,C as B,k as Q,r as i,x as _,D as Z,c as m,o as p,b as r,w as d,e as n,J as ee,f as oe,g as a,l as se,h,y as u,p as ae,F as le,z as g,v,A as z,m as j,n as te,T as ne,H as ie,E as re,a7 as D,i as de,I as ue,M as pe,Y as me,t as ce}from"./index-G9ZV8JxE.js";import{s as ve,o as fe}from"./index-DdFdx48A.js";import{l as ge}from"./loadGoogleMap-DZ-zVA3K.js";import"./index-93e-Jyro.js";const ye={style:{padding:"13px 0 20px 0"}},be={class:"form-card"},Ve={class:"field-wrapper"},we={key:0,class:"field-footer"},ke={class:"field-wrapper"},_e={key:0,class:"field-footer"},he={class:"input-group"},Ne={key:0,class:"field-footer"},Ae={style:{"text-align":"center","padding-bottom":"27px"}},xe={class:"field-wrapper"},Pe={class:"field-wrapper"},Ue={key:0},Ie={key:1},ze={class:"flex items-center gap-2"},Ce={key:0,class:"field-footer"},Ee={class:"field-wrapper"},Se={class:"field-wrapper"},Me={class:"field-wrapper"},Be={class:"field-wrapper"},je={class:"message-counter"},De={class:"field-wrapper"},Le={class:"field-wrapper"},Te=Object.assign({name:"provider-form"},{__name:"ProviderForm",emits:["createPro"],setup(Fe,{emit:L}){const T=L,s=B({proName:"",ideNum:"",profession:"",address:""}),F=oe(),N=Q(),l=B({}),y=i(!1),A=i(!1),C=i(""),H=i(null),G=fe,b=i(0),x=i(0),V=i(""),c=i("hour"),w=i(""),P=i("");let E=i("");const J=i(!1),S=i(t=>{let e=t.target.value.replace(/[^0-9.]/g,"");const f=e.split(".");f.length>2&&(e=f[0]+"."+f.slice(1).join("")),e.startsWith(".")&&(e="0"+e),t.target.value=e,E.value=e}),U=i(null),I=i(!1),R=()=>(l.proName=s.proName?"":"Nimi on pakollinen!",l.ideNum=s.ideNum?"":"Ident num on pakollinen!",l.profession=s.profession?"":"Ammatti on pakollinen!",l.address=s.address?"":"Osoite on pakollinen!",!l.proName&&!l.ideNum&&!l.profession&&!l.address);_(()=>s.proName,()=>l.proName=""),_(()=>s.ideNum,()=>l.ideNum=""),_(()=>s.profession,()=>l.profession=""),_(()=>s.address,()=>l.address=""),i(!1),Z(async()=>{await q()});const q=async()=>{try{await ge(),console.log("Map is inited in Pro form! ✅");const t={lat:50.064192,lng:-130.605469},o={north:t.lat+.1,south:t.lat-.1,east:t.lng+.1,west:t.lng-.1},e=document.getElementById("pro-location"),f={bounds:o,componentRestrictions:{country:"fi"},fields:["address_components","geometry","icon","name","formatted_address"],strictBounds:!1},M=new google.maps.places.Autocomplete(e,f);M.addListener("place_changed",()=>{let k=M.getPlace();b.value=k.geometry.location.lat(),x.value=k.geometry.location.lng(),s.address=k.formatted_address,console.log(k)})}catch(t){console.error("Google Maps failed to load ❌",t),J.value=!0}},O=async()=>{navigator.geolocation&&await navigator.geolocation.getCurrentPosition(t=>{const{latitude:o,longitude:e}=t.coords;b.value=o,x.value=e,console.log("Pro latitude is: "+b.value),W(o,e)})},W=(t,o)=>{ce.get("https://maps.googleapis.com/maps/api/geocode/json?latlng="+t+","+o+"&key=AIzaSyDt2YXE5tk0J72JgqnH3DTD7MeoqbbWBmU").then(e=>{e.data.error_message?console.log(e.data.error_message):(s.address=e.data.results[1].formatted_address,console.log("Address now "+s.address))}).catch(e=>{console.log(e.message)})},Y=()=>{y.value=!0,O()},K=()=>{y.value=!1,s.address=""},X=async()=>{if(!R())console.log("Some error! "+l),C.value="Form kentät pitää huomioida!",A.value=!0;else{console.log("Provider is created!"),console.log("Submit pro");const t={pName:s.proName,ide:s.ideNum,description:w.value,address:s.address,latitude:b.value,longitude:x.value,profession:s.profession.label,priceByHour:c.value==="hour"?P.value:null,range:V.value===null?0:V.value,proLink:U.value,isAvailable24_7:I.value},o=await me.addProvider(N.user.id,t);console.log("Added provider::: "+o),o?(o.user={id:N.user.id,username:N.user.username},T("createPro",o),F.push("/pro-panel")):console.log("Tapahtui virhe, yritä uudelleen!")}};return(t,o)=>(p(),m("div",null,[r(n(ee),null,{default:d(()=>[a("div",ye,[r(n(se),{modelValue:A.value,"onUpdate:modelValue":o[1]||(o[1]=e=>A.value=e),autohide:"",delay:3e3,stacking:!1,position:"top-center",toast:"danger",icon:"fas fa-exclamation-circle fa-lg me-2"},{title:d(()=>[...o[14]||(o[14]=[h(" TAPAHTUI VIRHE! ",-1)])]),small:d(()=>[...o[15]||(o[15]=[])]),default:d(()=>[a("button",{type:"button",style:{visibility:"hidden"},class:"btn-close ms-auto","aria-label":"Close",onClick:o[0]||(o[0]=(...e)=>t.hideError&&t.hideError(...e))}),h(" "+u(C.value),1)]),_:1},8,["modelValue"])]),a("div",be,[a("form",{onSubmit:ae(X,["prevent"])},[a("div",Ve,[r(n(v),{label:"Anna yrityksen tai oma nimi *",modelValue:s.proName,"onUpdate:modelValue":o[2]||(o[2]=e=>s.proName=e),id:"yritys",size:"lg"},null,8,["modelValue"]),l.proName?(p(),m("span",we,u(l.proName),1)):g("",!0)]),a("div",ke,[r(n(v),{label:"Anna yrityksen y-tunnus",modelValue:s.ideNum,"onUpdate:modelValue":o[3]||(o[3]=e=>s.ideNum=e),id:"ytunnus",size:"lg"},null,8,["modelValue"]),l.ideNum?(p(),m("span",_e,u(l.ideNum),1)):g("",!0)]),a("div",{class:z([{hideProInput:!s.address&&y.value},"field-wrapper"]),style:{width:"100%"}},[a("div",he,[r(n(v),{size:"lg",id:"pro-location",modelValue:s.address,"onUpdate:modelValue":o[4]||(o[4]=e=>s.address=e),label:"Anna osoite",placeholder:"",wrapperClass:"form-outline flex-grow-3",inputClass:"ps-0","aria-describedby":"button-addon2"},null,8,["modelValue"]),r(n(j),{type:"button",style:{border:"1px solid #ddd"}},{default:d(()=>[r(n(te),{size:"2x",onClick:o[5]||(o[5]=e=>s.address?K():Y())},{default:d(()=>[a("i",{class:z(s.address?"fas fa-times":"fas fa-search-location")},null,2)]),_:1})]),_:1})]),l.address?(p(),m("span",Ne,u(l.address),1)):g("",!0)],2),le(a("div",Ae,[r(n(ne),{grow:"",color:"info"})],512),[[ie,!s.address&&y.value]]),o[18]||(o[18]=a("p",{style:{"text-align":"left",color:"deepskyblue","font-size":"18px"}},"jos sädettä ei ole merkitty, se tarkoittaa, että tarjoat palvelua vain määritetyssä osoitteessa",-1)),a("div",xe,[r(n(v),{type:"text",value:H.value,onInput:S.value,label:"Anna toiminta-alueen säde - km",modelValue:V.value,"onUpdate:modelValue":o[6]||(o[6]=e=>V.value=e),size:"lg"},null,8,["value","onInput","modelValue"])]),a("div",Pe,[r(n(ve),{style:re([{width:"100%"},t.isNoPro?"color: pink; border: 1px solid red;":"color: white;"]),modelValue:s.profession,"onUpdate:modelValue":o[7]||(o[7]=e=>s.profession=e),options:n(G),filter:"",optionLabel:"label",optionGroupLabel:"label",optionGroupChildren:"items",placeholder:"Anna om aammatti *",class:"w-full md:w-[30rem]"},{value:d(e=>[e.value?(p(),m("div",Ue,[a("div",null,u(e.value.label),1)])):(p(),m("span",Ie,u(e.placeholder),1))]),optiongroup:d(e=>[a("div",ze,[a("i",{class:z(e.option.icon),style:{"font-size":"17px",color:"cadetblue"}},null,2),o[16]||(o[16]=h("    ",-1)),a("span",null,u(e.option.label),1)])]),_:1},8,["modelValue","options","style"]),l.profession?(p(),m("span",Ce,u(l.profession),1)):g("",!0)]),a("div",Ee,[r(n(D),{label:"Tuntihinta",name:"aboutPrice",modelValue:c.value,"onUpdate:modelValue":o[8]||(o[8]=e=>c.value=e),value:"hour"},null,8,["modelValue"])]),a("div",Se,[c.value==="hour"?(p(),de(n(v),{key:0,label:"Anna tuntihinta",type:"text",onInput:S.value,value:n(E),modelValue:P.value,"onUpdate:modelValue":o[9]||(o[9]=e=>P.value=e),size:"lg"},null,8,["onInput","value","modelValue"])):g("",!0)]),a("div",Me,[r(n(D),{label:"Urakkahinta",name:"aboutPrice",modelValue:c.value,"onUpdate:modelValue":o[10]||(o[10]=e=>c.value=e),value:"piece"},null,8,["modelValue"])]),a("div",Be,[r(n(ue),{maxlength:"100",modelValue:w.value,"onUpdate:modelValue":o[11]||(o[11]=e=>w.value=e),label:"Kirjuta siia midagi endast ja oma tegevusest..."},null,8,["modelValue"]),a("span",je,u(w.value.length)+" / 100",1)]),a("div",De,[r(n(v),{label:"Anna yrityksen kotisivun osoite jos on",size:"lg",modelValue:U.value,"onUpdate:modelValue":o[12]||(o[12]=e=>U.value=e)},null,8,["modelValue"])]),a("div",Le,[r(n(pe),{label:"Saatavilla 24/7",modelValue:I.value,"onUpdate:modelValue":o[13]||(o[13]=e=>I.value=e)},null,8,["modelValue"])]),r(n(j),{color:"primary",type:"submit"},{default:d(()=>[...o[17]||(o[17]=[h("Luo tili",-1)])]),_:1})],32)])]),_:1})]))}}),qe=$(Te,[["__scopeId","data-v-e503a8b6"]]);export{qe as default};
