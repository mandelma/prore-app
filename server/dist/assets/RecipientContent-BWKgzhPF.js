import{P as q,aZ as K,k as U,Q as R,c,o as a,g as t,b as o,e,R as I,w as i,x as r,b1 as $,h as k,m as C,K as P,u as Y,r as h,i as w,J as j,q as E,y as V,Z as z,G as v,z as B,S as Z,N as F,O as J,b4 as Q,b5 as A}from"./index-DW7v6QT8.js";/* empty css                                                                         */import{_ as L}from"./_plugin-vue_export-helper-DlAUqK2U.js";const W={style:{display:"flex","justify-content":"right",padding:"7px"}},X={class:"mb-3"},ee={class:"right-side"},te=Object.assign({name:"offer-content"},{__name:"OfferContent",props:{offerId:{type:String}},emits:["quit-content","quit-content-confirmed"],setup(s,{emit:O}){const m=q(),b=K(),g=U(),{bookings:_}=R(m),{user:y}=R(g),p=O,S=()=>{p("quit-content"),console.log("Yees")},u=m.getOfferById(s.offerId),x=async()=>{console.log("Ordering the provider to the booking - "+u.bookingID),u.sender,y.value.id;const D=u.bookingID,f="Sopimus tehty!",T=`${y.value.firstName} on vahvistanut tilauksen - "${_.value.find(l=>l.id===u.bookingID).header}". Tarkemmat tiedot kalenterissa!`;if(await P.updateRecipientStatus(u.bookingID,{status:"confirmed"}),!await P.addConfirmedOffer(u.bookingID,u))return;const N={bookingId:D,isNewMsg:!0,isLink:!0,title:f,content:T,reason:"",sender:y.value.firstName};await m.confirmOffer(u),await b.clientConfirmDealNotification(D,u.sender,N),p("quit-content-confirmed",u.name)};return(D,f)=>(a(),c("div",null,[t("div",W,[o(e(I),{white:"",onClick:S})]),o(e($),{variant:"dark"},{default:i(()=>[t("tbody",null,[t("tr",null,[f[0]||(f[0]=t("td",null," Yritys ",-1)),t("td",null,r(e(u).name),1)]),t("tr",null,[f[1]||(f[1]=t("td",null,"Y-tunnus",-1)),t("td",null,r(e(u).provider.ide),1)]),t("tr",null,[f[2]||(f[2]=t("td",null," Osoite ",-1)),t("td",null,r(e(u).provider.address),1)])])]),_:1}),t("div",X,[o(e(C),{color:"primary",onClick:x,block:""},{default:i(()=>[...f[3]||(f[3]=[k("Tilaa",-1)])]),_:1})]),t("div",ee,[o(e(C),{color:"dark"},{default:i(()=>[...f[4]||(f[4]=[t("i",{class:"far fa-comment"},null,-1)])]),_:1})])]))}}),ne=L(te,[["__scopeId","data-v-1425b5c2"]]),oe="/assets/load-pro-offers-BVLHVvbK.gif",ie={style:{display:"flex","justify-content":"right",padding:"20px"}},se={key:0,class:"spinner-border",role:"status"},le={key:1,class:"booking-content"},ae={class:"client-result-header"},re={key:0,class:"expired_date"},de={key:0},ue={key:1},ce={style:{display:"flex","justify-content":"right",cursor:"pointer"}},fe={key:0},ge={key:0},ke={key:1},pe={key:0},me={key:1},be={key:0,class:"form-card"},ye={class:"w-100 position-relative"},ve={style:{"font-size":"12px"}},Ce={style:{"font-size":"11px"}},_e={style:{"font-size":"11px"}},De={key:1},he={style:{width:"100%","margin-top":"12px"}},we=["src"],xe=Object.assign({name:"recipient-content"},{__name:"RecipientContent",props:{booking:{type:Object},bIndex:{type:Number}},emits:["cancelRecipientContent","canselRecipientContentConfirmed","out-here","updateOfferState"],setup(s,{emit:O}){const m=s,b=O,{t:g}=Y(),_=q();h([]);const y=h(""),p=h(!1),S=oe,u=h([{text:"Distance",value:25}]),x=h(!1),{bookings:D}=R(_),f=async(l,n)=>{console.log("Provider info"+l),console.log("booking id - "+n.bookingID),p.value=!0,y.value=n.id,await _.readOffer(n),b("updateOfferState",n.bookingID,n.id)},T=()=>{b("cancelRecipientContent")},M=l=>{console.log("Quitting content! "+l),p.value=!1,b("canselRecipientContentConfirmed",l)},N=async()=>{console.log("BOOKING ID "+m.booking.id),await _.onRemovePublicBooking(m.booking.id),b("out-here")};return(l,n)=>{const H=E("MDBTextarea"),G=E("VueDatePicker");return p.value?(a(),w(e(j),{key:0},{default:i(()=>[t("div",null,[o(ne,{offerId:y.value,onQuitContent:n[0]||(n[0]=d=>p.value=!1),onQuitContentConfirmed:M},null,8,["offerId"])])]),_:1})):(a(),w(e(j),{key:1},{default:i(()=>[t("div",ie,[o(e(I),{white:"",style:{cursor:"pointer"},onClick:T})]),e(D)?(a(),c("div",le,[t("h2",ae,r(e(g)("recipient_result_need_a_pro"))+" - "+r(s.booking.professional[0]),1),s.booking.created_ms-new Date().getTime()<=0&&s.booking.offers.length<1?(a(),c("h5",re,r(e(g)("recipient_result_order_is_expired")),1)):V("",!0),o(e(z),{style:{"margin-top":"50px"}},{default:i(()=>[o(e(v),{class:"client-result"},{default:i(()=>[o(e($),{borderless:"",style:{"font-size":"14px",color:"#dddddd","text-align":"left"}},{default:i(()=>[t("tbody",null,[t("tr",null,[l.isEditDescription?(a(),c("td",ue,[o(e(z),null,{default:i(()=>[o(e(v),null,{default:i(()=>[o(H,{label:e(g)("recipient_result_edit_description"),white:"",rows:"4",modelValue:l.description,"onUpdate:modelValue":n[1]||(n[1]=d=>l.description=d),style:{"font-size":"14px",padding:"20px"}},null,8,["label","modelValue"])]),_:1}),o(e(v),{col:"1"},{default:i(()=>[t("div",ce,[o(e(I),{white:"",onClick:n[2]||(n[2]=d=>l.isEditDescription=!1)})])]),_:1})]),_:1})])):(a(),c("td",de,[t("p",null,r(s.booking.description),1)]))]),s.booking.offers.length<1?(a(),c("tr",fe,[l.isEditDescription?(a(),c("td",ke,[o(e(C),{outline:"info",block:"",size:"lg",onClick:l.saveEditedDescription},{default:i(()=>[...n[8]||(n[8]=[k("Tallenna tehtävän kuvaus",-1)])]),_:1},8,["onClick"])])):(a(),c("td",ge,[o(e(C),{outline:"info",block:"",size:"lg",onClick:l.pressedEditDescription},{default:i(()=>[...n[7]||(n[7]=[k("Muokkaa tehtävän kuvausta",-1)])]),_:1},8,["onClick"])]))])):V("",!0),t("tr",null,[x.value?(a(),c("td",me,[o(e(z),null,{default:i(()=>[o(e(v),{col:"8"},{default:i(()=>[t("h4",{class:B({expired_date:s.booking.created_ms-new Date().getTime()<=0})},[k(r(l.bookingDateToDisplay),1),n[9]||(n[9]=t("br",null,null,-1)),k(" klo   "+r(new Date(s.booking.created).getHours()<10?"0"+new Date(s.booking.created).getHours():new Date(s.booking.created).getHours())+" : "+r(new Date(s.booking.created).getMinutes()<10?"0"+new Date(s.booking.created).getMinutes():new Date(s.booking.created).getMinutes()),1)],2),o(G,{style:{"margin-bottom":"20px"},dark:"",modelValue:l.bookingDate,"onUpdate:modelValue":n[3]||(n[3]=d=>l.bookingDate=d),"min-date":new Date,placeholder:e(g)("recipient_result_select_date"),onInternalModelChange:l.handleInternalDate,state:l.isNoDate?!1:null},null,8,["modelValue","min-date","placeholder","onInternalModelChange","state"])]),_:1}),o(e(v),{col:"4"},{default:i(()=>[o(e(I),{white:"",onClick:n[4]||(n[4]=d=>x.value=!1),style:{float:"right",cursor:"pointer"}})]),_:1})]),_:1})])):(a(),c("td",pe,[t("p",{class:B({expired_date:s.booking.created_ms-new Date().getTime()<=0&&s.booking.offers.length<1})},r(s.booking.date)+"   ",3),s.booking.offers.length<1?(a(),w(e(C),{key:0,block:"",size:"lg",outline:"info",onClick:l.editDate},{default:i(()=>[t("span",{class:B({expired_warning:s.booking.created_ms-new Date().getTime()<=0})},r(e(g)("recipient_result_edit_date")),3)]),_:1},8,["onClick"])):V("",!0)]))])])]),_:1})]),_:1}),o(e(v),{lg:"6"},{default:i(()=>[s.booking.offers.length>0?(a(),c("div",be,[n[13]||(n[13]=t("h3",{style:{padding:"13px"}},"Tehtyjä tarjouksia",-1)),o(e(Z),{theme:"dark",size:"lg",style:{"margin-bottom":"17px"},white:"",options:u.value,"onUpdate:options":n[5]||(n[5]=d=>u.value=d),label:"Filter"},null,8,["options"]),o(e($),{style:{width:"100%","font-size":"12px","text-align":"center"}},{default:i(()=>[t("tbody",null,[(a(!0),c(F,null,J(s.booking.offers,d=>(a(),c("tr",{key:d.id},[t("td",null,[t("div",ye,[o(e(C),{class:"provider-selection",outline:"info",block:"",size:"lg",onClick:Ie=>f(d.provider,d)},{default:i(()=>[k(r(d.name)+" ",1),n[10]||(n[10]=t("br",null,null,-1)),t("span",ve,r(e(g)("recipient_result_distance"))+" "+r(d.distance),1),n[11]||(n[11]=t("br",null,null,-1))]),_:2},1032,["onClick"]),d.isNewOffer?(a(),w(e(Q),{key:0,color:"danger",class:"translate-middle p-2",pill:"",notification:""},{default:i(()=>[t("span",Ce,[k(r(e(g)("recipient_result_new"))+" ",1),n[12]||(n[12]=t("br",null,null,-1)),k(r(d.price)+" eur ",1)])]),_:2},1024)):(a(),w(e(Q),{key:1,color:"info",class:"position-absolute top-0 start-100 translate-middle",pill:"",notification:""},{default:i(()=>[t("span",_e,r(d.price)+" eur ",1)]),_:2},1024))])])]))),128))])]),_:1})])):(a(),c("div",De,[t("h2",he,r(e(g)("recipient_result_waiting_offers")),1),t("img",{src:e(S),alt:"loading_offers"},null,8,we)])),o(e(A),{modal:"",style:{float:"right","margin-top":"27px"},class:"pc-trigger-danger",message:"Oletko varma, että haluat poista tilauksen?",cancelText:"En",confirmBtnClasses:"popconfirm-ok-btn",confirmText:"Poista tilaus",tag:"button",onConfirm:N},{default:i(()=>[k(r(e(g)("recipient_result_remove_order")),1)]),_:1})]),_:1})]),_:1})])):(a(),c("div",se,[...n[6]||(n[6]=[t("span",{class:"visually-hidden"},"Loading...",-1)])]))]),_:1}))}}}),Ne=L(xe,[["__scopeId","data-v-aee839d7"]]);export{Ne as default};
