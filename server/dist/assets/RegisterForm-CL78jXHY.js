import{t as T,r as l,k as I,x as P,i as H,o as V,w as m,e as s,J,f as K,g as n,b as t,l as Z,h as x,y as C,p as D,c as S,z as h,v as f,m as U,A as z,M as O,s as q}from"./index-B6-cChpL.js";const G="/api/users",Q=async E=>(await T.post(`${G}`,E)).data,W={addUser:Q},X={style:{padding:"13px 0 20px 0"}},Y={class:"input-group mb-3"},ee={key:0,style:{color:"palevioletred"}},ae={class:"input-group mb-3"},le={key:1,style:{color:"palevioletred"}},se={class:"form-actions"},te=Object.assign({name:"register-form"},{__name:"RegisterForm",setup(E){const j=K(),v=l(""),g=l(""),i=l(""),u=l(""),o=l(""),p=l(""),N=l(!0),b=l(!1),y=l(!1),r=l(!1),w=l(""),k=l("");l(""),l(""),l(""),l("");const d=l(""),A=I(),L=()=>{r.value=!1},F=()=>{console.log("Password is toggled"),b.value=!b.value},$=()=>{console.log("Password confirm is toggled!"),y.value=!y.value},M=()=>{/^(?=.*[A-Z])(?=.*\d)(?=.*[!@#$%^&*()_\-+=\[\]{};':"\\|,.<>/?]).{8,}$/.test(o.value)?w.value="":w.value="Salasanan on oltava vähintään 8 merkkiä pitkä ja sen on sisällettävä iso kirjain, numero ja erikoismerkki."},R=()=>{/^(?=.*[A-Z])(?=.*\d)(?=.*[!@#$%^&*()_\-+=\[\]{};':"\\|,.<>/?]).{8,}$/.test(p.value)?k.value="":k.value="Salasanan on oltava vähintään 8 merkkiä pitkä ja sen on sisällettävä iso kirjain, numero ja erikoismerkki."};P(o,c=>{M()}),P(p,c=>{R()});const _=async()=>{const c={firstName:v.value,lastName:g.value,username:i.value,email:u.value,password:o.value};if(v.value!==""&&g.value!==""&&i.value!==""&&o.value!==""&&u.value!=="")if(i.value.length<4)r.value=!0,d.value="Username must be longer than 4 characters!";else if(!/^[^@]+@\w+(\.\w+)+\w$/.test(u.value))r.value=!0,d.value="Anna kelvollinen sähköpostiosoite!";else if(o.value!==p.value)r.value=!0,d.value="Salasana on oltava sama!";else{console.log("Uus kasutaja");const e=await W.addUser(c);if(e.error==="username existing")r.value=!0,d.value="Käyttäjätunnus on jo olemassa! Vaihda käyttäjätunnus";else if(e.error==="email existing")r.value=!0,d.value="Antamasi sähköpostiosoite on jo olemassa!";else{console.log("registerFirstName "+v.value),console.log("registerLastName "+g.value),console.log("registerUsername "+i.value),console.log("registerPassword "+o.value),console.log("registerEmail "+u.value);const a=await q.login({username:i.value,password:o.value});console.log("Login error: "+a.error),a.error!=="login error"?(A.onLogin(a),B(),await j.push("/")):console.log("Error with login! "+a.error)}}else r.value=!0,d.value="Kaikki kentät ovat täytettävä!!"},B=()=>{console.log("registerFirstName "+v.value),console.log("registerLastName "+g.value),console.log("registerUsername "+i.value),console.log("registerPassword "+o.value),console.log("registerEmail "+u.value)};return(c,e)=>(V(),H(s(J),null,{default:m(()=>[n("div",X,[t(s(Z),{modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=a=>r.value=a),autohide:"",delay:3e3,stacking:!1,position:"top-center",toast:"danger",icon:"fas fa-exclamation-circle fa-lg me-2"},{title:m(()=>[...e[8]||(e[8]=[x(" TAPAHTUI VIRHE! ",-1)])]),small:m(()=>[...e[9]||(e[9]=[])]),default:m(()=>[n("button",{type:"button",style:{visibility:"hidden"},class:"btn-close ms-auto","aria-label":"Close",onClick:L}),x(" "+C(d.value),1)]),_:1},8,["modelValue"])]),n("form",{class:"form-card",onSubmit:D(_,["prevent"]),autocomplete:"off"},[t(s(f),{type:"text",size:"lg",label:"Etunimi",id:"registerFirstName",modelValue:v.value,"onUpdate:modelValue":e[1]||(e[1]=a=>v.value=a),wrapperClass:"mb-4"},null,8,["modelValue"]),t(s(f),{type:"text",size:"lg",label:"Sukunimi",id:"registerLastName",modelValue:g.value,"onUpdate:modelValue":e[2]||(e[2]=a=>g.value=a),wrapperClass:"mb-4"},null,8,["modelValue"]),t(s(f),{type:"text",size:"lg",label:"käyttäjätunnus",id:"registerUsername",modelValue:i.value,"onUpdate:modelValue":e[3]||(e[3]=a=>i.value=a),wrapperClass:"mb-4"},null,8,["modelValue"]),t(s(f),{type:"text",size:"lg",label:"Email",id:"registerEmail",modelValue:u.value,"onUpdate:modelValue":e[4]||(e[4]=a=>u.value=a),wrapperClass:"mb-4"},null,8,["modelValue"]),n("div",Y,[t(s(f),{size:"lg",modelValue:o.value,"onUpdate:modelValue":e[5]||(e[5]=a=>o.value=a),type:b.value?"text":"password",label:"Anna salasana",wrapperClass:"form-outline flex-grow-3",inputClass:"ps-0","aria-describedby":"button-addon2"},null,8,["modelValue","type"]),t(s(U),{style:{border:"1px white"},type:"button"},{default:m(()=>[n("i",{class:z(b.value?"far fa-eye-slash":"far fa-eye"),style:{color:"#dddddd"},onClick:F},null,2)]),_:1})]),w.value&&o.value?(V(),S("p",ee,C(w.value),1)):h("",!0),n("div",ae,[t(s(f),{size:"lg",modelValue:p.value,"onUpdate:modelValue":e[6]||(e[6]=a=>p.value=a),type:y.value?"text":"password",label:"Toista salasana",wrapperClass:"form-outline flex-grow-3",inputClass:"ps-0","aria-describedby":"button-addon2"},null,8,["modelValue","type"]),t(s(U),{style:{border:"1px white"},type:"button"},{default:m(()=>[n("i",{class:z(y.value?"far fa-eye-slash":"far fa-eye"),style:{color:"#dddddd"},onClick:$},null,2)]),_:1})]),k.value&&p.value?(V(),S("p",le,C(k.value),1)):h("",!0),t(s(O),{label:"Muista minut",size:"lg",id:"registerSubscribeCheck",modelValue:N.value,"onUpdate:modelValue":e[7]||(e[7]=a=>N.value=a),wrapperClass:"d-flex justify-content-center mb-4"},null,8,["modelValue"]),n("div",se,[t(s(U),{color:"primary",size:"lg",type:"submit",block:"",class:"mb-4",disabled:!!w.value},{default:m(()=>[...e[10]||(e[10]=[x(" Luo tili ",-1)])]),_:1},8,["disabled"])])],32)]),_:1}))}});export{te as default};
